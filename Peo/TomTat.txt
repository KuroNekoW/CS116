TỔNG HỢP NHẬN ĐỊNH TIỀN XỬ LÝ DỮ LIỆU

1. Các cột ít thông tin – nên loại bỏ
cols_to_drop = [
    # SALES ITEM
    "is_deleted",                   
    "last_sync_date",               
    "sync_error_message",       
    "image_url",            
    "description_new",      
    "weight",
    "sync_status_id",
    "p_id",
    "item_id",
    "category_l1_id",
    "category_l2_id",
    "category_l3_id",
    "category_id",
    "description",
    "manufacturer",

    # SALES PURCHASE
    "is_deleted",
    "event_type",
    "user_id",
    "item_id",
    "customer_id",

    # SALES USER
    "is_deleted",
    "sync_status_id",
    "last_sync_date",
    "sync_error_message",
    "customer_id",
    "user_id",
]

2
3
4

5.
####  Từ `SALES ITEM`
- `item_age_days` = ngày hiện tại − `created_date`
- `is_new_brand` = brand xuất hiện ít trong toàn bộ dữ liệu

####  Từ `SALES PURCHASE`
- `purchase_hour`, `purchase_dayofweek` từ `timestamp`
- `is_weekend_purchase` = thứ 6–CN
- `discount_rate` = `discount` / `price`
- `purchase_count_per_item` = số lần item được mua

####  Từ `SALES USER`
- `is_loyal` = `membership` == 'Premium'
- `location_density` = số lượng user tại `location`

###  Rút trích đặc trưng

- **GroupBy + Count**: số lần mua theo item, user, brand

- **Datetime features**: phân tích theo giờ, ngày, tuần

- **Interaction features**: `price × discount_rate`
